<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HEADER AND FOOTER</title>
    <style type="text/css">
      body {
        margin: auto;
      }
      .content {
        height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .wrapper {
        text-align: center;
        flex-grow: 1;
      }
    </style>
  </head>
  <body class="content">
    <div id="header"></div>
    <div class="wrapper">
      <button type="button" onclick="setNewMessageIndicator('message-icon-first')">
        Показать индикатор новых сообщений в беседах
      </button>
      <button type="button" onclick="unsetNewMessageIndicator('message-icon-first')">
        Убрать индикатор новых сообщений в беседах
      </button>
    </div>
    <div id="footer"></div>

    <script type="module" src="src/main.js" onload="createWidgets()" onerror="logLoadError(this.src)"></script>
    <script>
      function createWidgets() {
        headerData = {
          fields: {
            logo: { url: "#", title: "Главная страница" },
            service_name: "Сервис электронного документооборота",
            right_part: [
              {
                type: "button",
                icon: "btn-folder",
                url: "#",
                title: "Архив долгосрочного хранения",
              },
              {
                type: "button",
                icon: "btn-home",
                url: "#",
                title: "Рабочее место исполнителя",
              },
              {
                type: "message",
                icon: "btn-message",
                url: "#",
                title: "Беседы",
                message_new: true,
                messageIconId: 'message-icon-first'
              },
              {
                type: "profile",
                text: "Иванов И. И.",
                url: "#",
                title: "Профиль",
              },
              {
                type: "logout",
                icon: "btn-logout",
                url: "#",
                title: "Выход",
                method: "delete",
                text: "Выйти из системы",
              },
            ]
          },
        }
        createHeader({data: headerData, element: "#header"})

        createFooter({element: "#footer"})
      }

      function logLoadError(file) {
        console.log( "Failed to load resource " + file + "!");
      }

      const script = document.querySelector("script[type=module]")
      if (!script.src.includes("/@vite/client")) {
        script.onload = createWidgets;
        script.onerror = function() { logLoadError(script.src); }
      }
    </script>
  </body>
</html>
